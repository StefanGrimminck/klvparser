package klvparser

import "math"

// KLVTag represents an individual KLV tag and its metadata.
type KLVTag struct {
	Name     string
	MinValue float64
	MaxValue float64
	Length   int
	Unit     string // Optional unit of measurement
	Value    interface{}
}

// tagMeta contains metadata for each MISB ST 0601 KLV tag.
// This map defines the name, range, length, unit of measurement, and value for each tag.
var tagMeta = map[int]*KLVTag{
	1:   {"Checksum", 0, 65535, 2, "None", nil},
	2:   {"Precision Time Stamp", 0, float64(math.MaxUint64), 8, "µs", nil},
	3:   {"Mission ID", 0, 0, 127, "None", nil},
	4:   {"Platform Tail Number", 0, 0, 127, "None", nil},
	5:   {"Platform Heading Angle", 0, 360, 2, "°", nil},
	6:   {"Platform Pitch Angle", -20, 20, 2, "°", nil},
	7:   {"Platform Roll Angle", -50, 50, 2, "°", nil},
	8:   {"Platform True Airspeed", 0, 255, 1, "m/s", nil},
	9:   {"Platform Indicated Airspeed", 0, 255, 1, "m/s", nil},
	10:  {"Platform Designation", 0, 0, 127, "None", nil},
	11:  {"Image Source Sensor", 0, 0, 127, "None", nil},
	12:  {"Image Coordinate System", 0, 0, 127, "None", nil},
	13:  {"Sensor Latitude", -90.0, 90.0, 4, "°", nil},
	14:  {"Sensor Longitude", -180.0, 180.0, 4, "°", nil},
	15:  {"Sensor True Altitude", -900.0, 19000.0, 2, "m", nil},
	16:  {"Sensor Horizontal Field of View", 0.0, 180.0, 2, "°", nil},
	17:  {"Sensor Vertical Field of View", 0.0, 180.0, 2, "°", nil},
	18:  {"Sensor Relative Azimuth Angle", 0.0, 360.0, 4, "°", nil},
	19:  {"Sensor Relative Elevation Angle", -180.0, 180.0, 4, "°", nil},
	20:  {"Sensor Relative Roll Angle", 0.0, 360.0, 4, "°", nil},
	21:  {"Slant Range", 0.0, 5000000.0, 4, "m", nil},
	22:  {"Target Width", 0.0, 10000.0, 2, "m", nil},
	23:  {"Frame Center Latitude", -90.0, 90.0, 4, "°", nil},
	24:  {"Frame Center Longitude", -180.0, 180.0, 4, "°", nil},
	25:  {"Frame Center Elevation", -900.0, 19000.0, 2, "m", nil},
	26:  {"Offset Corner Latitude Point 1", -0.075, 0.075, 2, "°", nil},
	27:  {"Offset Corner Longitude Point 1", -0.075, 0.075, 2, "°", nil},
	28:  {"Offset Corner Latitude Point 2", -0.075, 0.075, 2, "°", nil},
	29:  {"Offset Corner Longitude Point 2", -0.075, 0.075, 2, "°", nil},
	30:  {"Offset Corner Latitude Point 3", -0.075, 0.075, 2, "°", nil},
	31:  {"Offset Corner Longitude Point 3", -0.075, 0.075, 2, "°", nil},
	32:  {"Offset Corner Latitude Point 4", -0.075, 0.075, 2, "°", nil},
	33:  {"Offset Corner Longitude Point 4", -0.075, 0.075, 2, "°", nil},
	34:  {"Icing Detected", 0, 255, 1, "None", nil},
	35:  {"Wind Direction", 0.0, 360.0, 2, "°", nil},
	36:  {"Wind Speed", 0.0, 255.0, 1, "m/s", nil},
	37:  {"Static Pressure", 0.0, 5000.0, 2, "mbar", nil},
	38:  {"Density Altitude", -900.0, 19000.0, 2, "m", nil},
	39:  {"Outside Air Temperature", -128, 127, 1, "°C", nil},
	40:  {"Target Location Latitude", -90.0, 90.0, 4, "°", nil},
	41:  {"Target Location Longitude", -180.0, 180.0, 4, "°", nil},
	42:  {"Target Location Elevation", -900.0, 19000.0, 2, "m", nil},
	43:  {"Target Track Gate Width", 0, 255, 1, "m", nil},
	44:  {"Target Track Gate Height", 0, 255, 1, "m", nil},
	45:  {"Target Error Estimate CE90", 0.0, 4095.9375, 2, "m", nil},
	46:  {"Target Error Estimate LE90", 0.0, 4095.9375, 2, "m", nil},
	47:  {"Generic Flag Data 01", 0, 255, 1, "None", nil},
	48:  {"Security Local Metadata Set", 0, 0, 0, "None", nil},
	49:  {"Differential Pressure", 0.0, 5000.0, 2, "hPa", nil},
	50:  {"Platform Angle of Attack", -20.0, 20.0, 2, "°", nil},
	51:  {"Platform Vertical Speed", -180.0, 180.0, 2, "m/s", nil},
	52:  {"Platform Sideslip Angle", -20.0, 20.0, 2, "°", nil},
	53:  {"Airfield Barometric Pressure", 0.0, 5000.0, 2, "hPa", nil},
	54:  {"Airfield Elevation", -900.0, 19000.0, 2, "m", nil},
	55:  {"Relative Humidity", 0.0, 100.0, 1, "%", nil},
	56:  {"Platform Ground Speed", 0, 255, 1, "m/s", nil},
	57:  {"Ground Range", 0, float64(math.MaxUint64), 4, "m", nil},
	58:  {"Platform Fuel Remaining", 0.0, 10000.0, 2, "kg", nil},
	59:  {"Platform Call Sign", 0, 0, 127, "None", nil},
	60:  {"Weapon Load", 0, 0, 0, "None", nil},
	61:  {"Weapon Fired", 0, 0, 0, "None", nil},
	62:  {"Laser PRF Code", 0, 65535, 2, "None", nil},
	63:  {"Sensor Field of View Name", 0, 255, 1, "None", nil},
	64:  {"Platform Magnetic Heading", 0.0, 360.0, 2, "°", nil},
	65:  {"UAS Datalink LS Version Number", 0, 255, 1, "None", nil},
	66:  {"Target Location Covariance Matrix", 0, 0, 0, "None", nil},
	67:  {"Alternate Platform Latitude", -90.0, 90.0, 4, "°", nil},
	68:  {"Alternate Platform Longitude", -180.0, 180.0, 4, "°", nil},
	69:  {"Alternate Platform Altitude", -900.0, 19000.0, 2, "m", nil},
	70:  {"Alternate Platform Name", 0, 0, 127, "None", nil},
	71:  {"Alternate Platform Heading", 0.0, 360.0, 2, "°", nil},
	72:  {"Event Start Time UTC", 0, float64(math.MaxUint64), 8, "µs", nil},
	73:  {"RVT Local Set", 0, 0, 0, "None", nil},
	74:  {"VMTI Data Set", 0, 0, 0, "None", nil},
	75:  {"Sensor Ellipsoid Height", -900.0, 19000.0, 2, "m", nil},
	76:  {"Alternate Platform Ellipsoid Height", -900.0, 19000.0, 2, "m", nil},
	77:  {"Operational Mode", 0, 255, 1, "None", nil},
	78:  {"Frame Center Height Above Ellipsoid", -900.0, 19000.0, 2, "m", nil},
	79:  {"Sensor North Velocity", -327.67, 327.67, 2, "m/s", nil},
	80:  {"Sensor East Velocity", -327.67, 327.67, 2, "m/s", nil},
	81:  {"Image Horizon Pixel Pack", 0, 0, 0, "None", nil},
	82:  {"Corner Latitude Point 1", -90.0, 90.0, 4, "°", nil},
	83:  {"Corner Longitude Point 1", -180.0, 180.0, 4, "°", nil},
	84:  {"Corner Latitude Point 2", -90.0, 90.0, 4, "°", nil},
	85:  {"Corner Longitude Point 2", -180.0, 180.0, 4, "°", nil},
	86:  {"Corner Latitude Point 3", -90.0, 90.0, 4, "°", nil},
	87:  {"Corner Longitude Point 3", -180.0, 180.0, 4, "°", nil},
	88:  {"Corner Latitude Point 4", -90.0, 90.0, 4, "°", nil},
	89:  {"Corner Longitude Point 4", -180.0, 180.0, 4, "°", nil},
	90:  {"Platform True Airspeed Rate", -327.67, 327.67, 2, "m/s", nil},
	91:  {"Target Width Extended", 0, 1500000.0, 4, "m", nil},
	92:  {"Platform Angle of Attack Rate", -327.67, 327.67, 2, "°", nil},
	93:  {"Platform Sideslip Angle Rate", -327.67, 327.67, 2, "°", nil},
	94:  {"MIIS Core Identifier", 0, 0, 0, "None", nil},
	95:  {"SAR Motion Imagery Local Set", 0, 0, 0, "None", nil},
	96:  {"Target Width Extended", 0, 1500000.0, 4, "m", nil},
	97:  {"Range Image Local Set", 0, 0, 0, "None", nil},
	98:  {"Geo-Registration Local Set", 0, 0, 0, "None", nil},
	99:  {"Composite Imaging Local Set", 0, 0, 0, "None", nil},
	100: {"Segment Local Set", 0, 0, 0, "None", nil},
	101: {"Amend Local Set", 0, 0, 0, "None", nil},
	102: {"SDCC-FLP", 0, 0, 0, "None", nil},
	103: {"Density Altitude Extended", -900.0, 19000.0, 2, "m", nil},
	104: {"Sensor Ellipsoid Height Extended", -900.0, 19000.0, 2, "m", nil},
	105: {"Alternate Platform Ellipsoid Height Extended", -900.0, 19000.0, 2, "m", nil},
	106: {"Stream Designator", 0, 0, 127, "None", nil},
	107: {"Operational Base", 0, 0, 127, "None", nil},
	108: {"Broadcast Source", 0, 0, 127, "None", nil},
	109: {"Range To Recovery Location", 0, float64(math.MaxUint64), 4, "km", nil},
	110: {"Time Airborne", 0, float64(math.MaxUint64), 4, "s", nil},
	111: {"Propulsion Unit Speed", 0, float64(math.MaxUint64), 4, "RPM", nil},
	112: {"Platform Course Angle", 0, 360.0, 2, "°", nil},
	113: {"Altitude AGL", 0, float64(math.MaxUint64), 4, "m", nil},
	114: {"Radar Altimeter", 0, float64(math.MaxUint64), 4, "m", nil},
	115: {"Control Command", 0, 0, 0, "None", nil},
	116: {"Control Command Verification List", 0, 0, 0, "None", nil},
	117: {"Sensor Azimuth Rate", -327.67, 327.67, 2, "dps", nil},
	118: {"Sensor Elevation Rate", -327.67, 327.67, 2, "dps", nil},
	119: {"Sensor Roll Rate", -327.67, 327.67, 2, "dps", nil},
	120: {"On-board MI Storage Percent Full", 0.0, 100.0, 1, "%", nil},
	121: {"Active Wavelength List", 0, 0, 0, "None", nil},
	122: {"Country Codes", 0, 0, 0, "None", nil},
	123: {"Number of NAVSATs in View", 0, 255, 1, "count", nil},
	124: {"Positioning Method Source", 0, 255, 1, "None", nil},
	125: {"Platform Status", 0, 12, 1, "None", nil},
	126: {"Sensor Control Mode", 0, 255, 1, "None", nil},
	127: {"Sensor Frame Rate Pack", 0, 0, 0, "None", nil},
	128: {"Wavelengths List", 0, 0, 0, "None", nil},
	129: {"Target ID", 0, 0, 127, "None", nil},
	130: {"Airbase Locations", 0, 0, 0, "None", nil},
	131: {"Take-off Time", 0, float64(math.MaxUint64), 4, "µs", nil},
	132: {"Transmission Frequency", 0, float64(math.MaxUint64), 4, "MHz", nil},
	133: {"On-board MI Storage Capacity", 0, float64(math.MaxUint64), 4, "GB", nil},
	134: {"Zoom Percentage", 0.0, 100.0, 2, "%", nil},
	135: {"Communications Method", 0, 0, 127, "None", nil},
	136: {"Leap Seconds", -128, 127, 1, "s", nil},
	137: {"Correction Offset", -float64(math.MaxUint64), float64(math.MaxUint64), 8, "µs", nil},
	138: {"Payload List", 0, 0, 0, "None", nil},
	139: {"Active Payloads", 0, 0, 127, "None", nil},
	140: {"Weapons Stores", 0, 0, 0, "None", nil},
	141: {"Waypoint List", 0, 0, 0, "None", nil},
	142: {"View Domain", 0, 0, 0, "None", nil},
	143: {"Metadata Substream ID", 0, 0, 17, "None", nil},
}
